format_version: "13"
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
project_type: ios
workflows:
  archive_and_export_app:
    summary: null
    description: null
    steps:
    - git-clone@8: {}
    - script:
        title: Pod Update
        inputs:
        - content: |-
            #!/bin/bash
            # fail if any commands fails
            cd UnityiOSPOC && pod deintegrate && pod install && cd -
    - certificate-and-profile-installer@1: {}
    - script:
        title: Build
        inputs:
        - content: |-
            #!/bin/bash
            # fail if any commands fails
            rm -rf /Users/vagrant/git/Build
            rm -rf /Users/vagrant/git/UnityiOSPOC.xcarchive
            rm -rf /Users/vagrant/git/UnityiOSPOC.ipa
            rm -rf /Users/vagrant/git/DistributionSummary.plist
            xcodebuild -workspace UnityiOSPOC/UnityiOSPOC.xcworkspace -scheme UnityiOSPOC -configuration 'Release' -archivePath ./UnityiOSPOC.xcarchive archive
            xcodebuild -exportArchive -archivePath ./UnityiOSPOC.xcarchive -exportPath ./UnityiOSPOC.xcarchive -exportOptionsPlist ./ExportOptions.plist
            ls -lart /Users/vagrant/git/Build
meta:
  bitrise.io:
    stack: osx-xcode-15.4.x
    machine_type_id: g2-m1.4core